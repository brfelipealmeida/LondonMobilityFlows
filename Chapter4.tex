\chapter{Results and Discussion}
\label{chapterlabel4}
    \section{Parameters}
        \subsection{Flows}

        As evident from the observed movement patterns in Figure \ref{fig: observedflows_overview} , work-related and non-work-related flows exhibit a concentration of commuting trajectories within central London. Moreover, substantial flows are concentrated in the northeastern and southwestern regions of the city. The most notable difference between these two categories of flows lies in the concentration level: Work-related flows demonstrate a heightened level of convergence, whereas non-work-related flows display a distribution that extends spatially across a broader area.

    \begin{figure}[H]
        \centering
        \includegraphics[width=15cm]{Images/Hex_observed_overview.png}
        \caption{London's observed flows: work and non-work.}
        \label{fig: observedflows_overview}
    \end{figure}

        \subsection{Features}


        

        \subsection{Attractiveness Factor}
        
       As part of the analytical refinement process, it was excluded the variables "CS" (commercial services) and "SE" (Sport and Entertainment). These variables were omitted due to their elevated p-values, above 0.4, signalling a lack of statistical significance. Additionally, both models exhibited a notably high condition number. However, a significant improvement was observed upon removing these two variables. The condition number, originally at 1.27e+03, was substantially reduced to a more manageable 647 in both regression models. 

        In the workflow regression analysis, it is evident that the variables "EH," "PI," and "TR" have statistical significance since their p-values are low (all below 0.001). This indicates that these variables noticeably affect the dependent variable we are studying. Additionally, the high R-squared and adjusted R-squared values (0.863 and 0.860) signify that the model effectively explains much of the variation in the dependent variable.

\begin{table}[H]
\centering
\begin{tabular}{@{}lllll@{}}
\toprule
\textbf{Variables} & \textbf{coef} & \textbf{std err} & \textbf{P>|t|} \\ \midrule
Intercept & 932.6236 & 284.803 & 0.001 \\
AED & -14.0624 & 3.827 & 0.000 \\
AT & -42.8778 & 9.624 & 0.000 \\
\color[HTML]{9A0000} \textbf{EH} & \color[HTML]{9A0000} \textbf{33.2344} & \color[HTML]{9A0000} \textbf{6.902} & \color[HTML]{9A0000} \textbf{0.000} \\
MP & -32.6702 & 6.067 & 0.000 \\
\color[HTML]{9A0000} \textbf{PI} & \color[HTML]{9A0000} \textbf{80.2838} & \color[HTML]{9A0000} \textbf{6.608} & \color[HTML]{9A0000} \textbf{0.000} \\
RT & 5.8310 & 2.613 & 0.026 \\
\color[HTML]{9A0000} \textbf{TR} & \color[HTML]{9A0000} \textbf{18.1677} & \color[HTML]{9A0000} \textbf{6.916} & \color[HTML]{9A0000} \textbf{0.009} \\ \bottomrule
\textbf{R-squared} & 0.863 \\
\textbf{Adj. R-squared} & 0.860 \\
\textbf{Cond. No.} & 647. \\ \bottomrule
\hline
\end{tabular}
\caption{OLS Regression Results}
\label{tab:ols-results}
\end{table}

        Thus, within the context of workflows, the collective counts of Points of Interest from these three categories, namely "EH," "PI," and "TR," represent the Work-related Points of Interest.

        \begin{figure}[H]
            \centering
            \includegraphics[width=14cm]{Images/regression_work.png}
            \caption{Work - Linear Regression: Flows vs POI}
            \label{fig: Regression_work}
        \end{figure}

        Regarding the non-work flows regression analysis, we observe that the variables "EH," "PI," "RT," and "TR" also demonstrate statistical significance, as their p-values are very low (all below 0.001). This implies that these variables significantly impact the dependent variable. The R-squared and adjusted R-squared values (0.782 and 0.778) indicate that our model effectively clarifies a significant portion of the variation in the dependent variable.  

        \begin{table}[H]
        \centering
        \begin{tabular}{@{}lllll@{}}
        \toprule
        \textbf{Variables} & \textbf{coef} & \textbf{std err} & \textbf{P>|t|} \\ \midrule
        Intercept & 5655.2406 & 1030.797 & 0.000 \\
        AED & -75.1430 & 13.851 & 0.000 \\
        AT & -201.4072 & 34.834 & 0.000 \\
        \textcolor{customblue}{\textbf{EH}} & \textcolor{customblue}{\textbf{113.3599}} & \textcolor{customblue}{\textbf{24.982}} & \textcolor{customblue}{\textbf{0.000}} \\
        MP & -131.6164 & 21.959 & 0.000 \\
        \textcolor{customblue}{\textbf{PI}} & \textcolor{customblue}{\textbf{218.6156}} & \textcolor{customblue}{\textbf{23.916}} & \textcolor{customblue}{\textbf{0.000}} \\
        \textcolor{customblue}{\textbf{RT}} & \textcolor{customblue}{\textbf{58.1842}} & \textcolor{customblue}{\textbf{9.456}} & \textcolor{customblue}{\textbf{0.000}} \\
        \textcolor{customblue}{\textbf{TR}} & \textcolor{customblue}{\textbf{73.5557}} & \textcolor{customblue}{\textbf{25.033}} & \textcolor{customblue}{\textbf{0.003}} \\ \bottomrule
        \textbf{R-squared} & 0.782 \\
        \textbf{Adj. R-squared} & 0.778 \\
        \textbf{Cond. No.} & 647. \\ \bottomrule
        \hline
        \end{tabular}
        \caption{OLS Regression Results}
        \label{tab:ols-results-new-bold-color}
        \end{table}

        In the non-work flows context, the combined counts of Points of Interest from these four categories, "EH," "PI," "RT," and "TR," symbolise the Non-Work-related Points of Interest. Thus, both regression models appear well-suited for explaining the relationships between the independent and dependent variables.


        \begin{figure}[H]
            \centering
            \includegraphics[width=14cm]{Images/regression_nonwork.png}
            \caption{Non-Work - Linear Regression: Flows vs POI}
            \label{fig: Regression_nonwork}
        \end{figure}


        In the context of residuals within both models(Figure \ref{fig: Residuals - Overview}), it is crucial to note that their distribution is normal, a fundamental assumption in regression analysis. This normal distribution holds significance because it indicates that errors in the model's predictions are distributed evenly around zero. Furthermore, the concentration of values is near zero when assessing the relationship between residuals and fitted values. This pattern confirms the suitability of the chosen linear regression models for the analysis.
        
        \begin{figure}[H]
            \centering
            \includegraphics[width=14cm]{Images/Residuals_overview.png}
            \caption{Residuals - Overview}
            \label{fig: Residuals - Overview}
        \end{figure}
        
 

        The map below(Figure \ref{fig: POI_map}) illustrates the spatial distribution of Points of Interest (POI) in London, categorising them into work-related and non-work-related. It becomes evident that their distribution across the city exhibits a degree of similarity, predominantly concentrating in inner London instead of outer London. However, it is worth emphasising that the total number of points differs significantly due to the non-work category that contains four distinct POI groups. The POI values for non-work are also correlated with mobility flow values distribution, as the proportions remain consistent. Work-related flows represent only a fraction of the city's overall journeys, whereas non-work flows encompass a broader spectrum of activities.

        \begin{figure}[H]
            \centering
            \includegraphics[width=14cm]{Images/POI_map.png}
            \caption{Points of Interest spatial distribution: Work and Non-work}
            \label{fig: POI_map}
        \end{figure}

        Additionally, the analysis reveals varying concentration patterns between the two categories of amenities. Work-related amenities exhibit a higher concentration in the city centre, whereas non-work amenities exhibit a more gradual and dispersed distribution throughout the city. This nuanced spatial distinction highlights these amenities' differential nature and accessibility for London's residents and visitors.

        \subsection{Population}
 
        To standardise the data, the 2021 census population data was aggregated, aligning it with the level 7 hexagons, as visually represented in the map below(Figure \ref{fig: Population Census}). This aggregation illustrate a significant concentration of residents within inner London, especially within the northeastern quadrant. While some other areas display a more dispersed spatial distribution, central London's concentration closely reflects the distribution patterns evident in the Points of Interest dataset and the mobility flows data.
        
        \begin{figure}[H]
            \centering
            \includegraphics[width=12cm]{Images/population.png}
            \caption{Population - UK Census 2021}
            \label{fig: Population Census}
        \end{figure}

    \section{Production-constrained Model}    

    \section{Deep gravity Model} 
    
    \section{Comparative analysis of the models}  

    The application of the spatial interaction model revealed limitations in processing large amounts of data from the Mobility dataset. On the other hand, the Deep Gravity Model displayed notable predictive capabilities. Notably, the observed flows within the Locomizer dataset are concentrated in London's central and eastern regions. The Deep Gravity Model covered a similar geographical region as the observed flows, with a different flow density distribution, which was notably higher for longer distances.


    
       \begin{figure}[H]
            \centering
            \includegraphics[width=14cm]{Images/Flows_regression.png}
            \caption{Flows - Regression plot}
            \label{fig: Flows - Regression}
        \end{figure}

    In the context of non-workflows,  both models demonstrate a comparable performance when contrasted with the workflows. The observed flows highlight that non-work flows also occupy the southwestern part of London, alongside select northern regions. The spatial interaction model demonstrates a low performance for both flow types, with no significant disparity in predictive ability.
    
    In contrast, the Deep Gravity Model exhibits good predictive performance for non-work flows compared to workflows, effectively covering nearly similar regions as indicated by the observed flows. This outcome suggests that the Deep Gravity Model is particularly adept at capturing the dynamics of non-work-related mobility, offering a significant advantage in this specific aspect of flow prediction.
        
        \begin{figure}[H]
            \centering
            \includegraphics[width=15cm]{Images/Hex_comparativeanalysis.png}
            \caption{Non-work flows}
            \label{fig: nWF Model after calibration}
        \end{figure}

    In assessing the performance of the models in predicting flows, it is evident that the R-squared values for Non-work flows outperform those for workflows, with a notable high value of 0.79 observed in the production-constrained model for non-work flows. R-squared serves as a valuable metric for comprehending the influence of variables on flow prediction. Consequently, it becomes crucial to measure the efficacy of each model in estimating flows and the capability of selected independent variables in predicting the outcome. Among these variables, including distance, population, and the attractiveness factor derived from Points of Interest (POI), it is evident that they demonstrate superior performance in estimating flows, particularly within the production-constrained framework for non-work flows, outperforming other models. Because of that, evaluating the Root Mean Square Error (RMSE) arises as an essential measure for comparing and evaluating the models against each other.

        \begin{table}[H]
        \centering
        \begin{tabular}{@{}lll@{}}
        \toprule
        \textbf{Flows type} & \textbf{Deep Gravity} & \textbf{Production-Constrained} \\ \midrule
        Work                & 0.66                  & 0.64                            \\
        Non-work            & 0.69                  & 0.79                            \\ \bottomrule
        \end{tabular}
            \caption{r-squared}
            \label{table: Table XX}
        \end{table}
    

    The performance of the models displayed significant variations depending on the specific type of flow under consideration. It is important to highlight that the Production-Constrained Model, when put to the test, yielded the lowest RMSE value, achieving a relevant score of 15.43 for work-related flows. On the other hand, the Deep Gravity Model showcased a significantly lower RMSE value, standing at 28.01, but this was for non-work flows. This contrast in performance underscores a pattern: the model designed around deep learning structures demonstrated its superiority when predicting non-work flows, often characterized by their complex and non-linear trajectories within the urban landscape.

    Non-work flows contain various activities and behaviours within a city, such as leisure, tourism, and social interactions. These activities tend to follow less predictable patterns, making them challenging to model accurately. However, with its inherent capacity to capture intricate relationships and dependencies within the data, the Deep Gravity Model excelled in this aspect. It showcased its ability to predict the diverse and sometimes complex mobility patterns associated with non-work-related activities, producing lower error rates.
    
    On the other hand, the traditional Spatial Interaction Model demonstrated its comparative advantage in estimating flows characterized by a more linear and structured relationship, primarily those about work-related activities. Workflows often follow established commuting routes and daily routines, resulting in more predictable mobility patterns. In these scenarios, the traditional model indicated greater accuracy in the workflow predictions. However, it obtained an RMSE rate for non-workflows.
    
    The model performance across these different flow types is concisely summarized in Table \ref{table: RMSE}, providing a comprehensive overview of how each model excelled in distinct aspects of mobility prediction.

        \begin{table}[h]
        \centering
        \begin{tabular}{@{}lll@{}}
        \toprule
        \textbf{Flows type} & \textbf{Deep Gravity} & \textbf{Production-Constrained} \\ \midrule
        Work                & 433.65                & 15.43                           \\
        Non-work            & 28.01                 & 387.67                          \\ \bottomrule
        \end{tabular}
            \caption{RMSE}
            \label{table: RMSE}
        \end{table}


\section{Discussion}

       The attractiveness factor utilised in the Spatial Interaction Model for Work and Non-work flows was constructed based on the categories within the POI dataset, see Figure \ref{fig: Attractiveness factor}. In the context of Workflows, the analysis revealed that Public Infrastructure (PI), Transport (TR), and Education and Health (EH) emerged as the most significant variables in the data collected from Mobility Data. In contrast, for the Non-work attractiveness factor, the primary variables align with those of the Workflows, except for Retail (RT).

        \begin{figure}[H]
            \centering
            \includegraphics[width=14cm]{Images/Atractiveness factor.png}
            \caption{Attractiveness factor}
            \label{fig: Attractiveness factor}
        \end{figure}

        This outcome provides valuable insights into the correlation of these two types of flows concerning user destinations. However, it is essential to note that the presence of these Points of Interest does not imply that they exclusively represent places of work or leisure destinations. It signifies the concentration of these amenity categories within specific geographic regions(hexagons), where opportunities for work or leisure coexist.

        To illustrate this, in the context of workflows, the coexistence of Points of Interest related to Public Infrastructure, Transport, Education, and Health suggests a likely concentration of work-related activities within that region. On the other hand, Non-work flows, including Retail as a relevant variable, are intriguing, as they pertain to flows unrelated to work, encompassing activities like visiting parks, schools, and cafes. Consequently, the aggregation of these four types of amenities is closely linked to the destinations of individuals in London who are not primarily there for work-related purposes.
        
        In the course of this study, a series of critical questions deserve careful consideration:
        
        Firstly, evaluating the relative performance of the Deep Gravity Model in estimating carbon emissions within the London area is essential. This assessment provides valuable insights into the model's effectiveness in capturing the complex dynamics of carbon emissions, which is crucial for understanding urban environmental impact.
        
        Secondly, the combined analysis of the Deep Gravity Model with accessibility measures presents a crucial path for investigation. This integration can enhance the model's predictive capacity by leveraging accessibility data, providing a more comprehensive understanding of the factors influencing carbon emissions.
        
        However, it is crucial to consider the limitations inherent in this analysis. Specifically, a need exists to enrich the features set, with a notable example being the incorporation of detailed street network information, as applied in the original model. Additionally, accounting for significant external variables such as weather conditions or events like strikes, which can significantly impact the mobility flows dynamic, is crucial to address the model's complexities.
        
        Besides that, it is crucial to consider additional performance metrics that can comprehensively assess the Deep Gravity Model's effectiveness relative to alternative methodologies to ensure a robust comparison.This broader perspective facilitates a comprehensive understanding of the strengths and weaknesses of each model, leading to more informed conclusions regarding their respective capabilities in mobility flow estimation. 

        Utilizing the mobility dataset from Locomizer has proven valuable for analyzing commuting dynamics. The data employed in this study is as recent as March, while the Census data concerning origin and destination data from 2011. Although these databases primarily have the retail market as one of their main audiences, their relevance extends far beyond, including urban planning. They offer a unique lens through which to comprehend the ever-evolving dynamics of cities, influenced by factors as diverse as climate crises, marked by intense weather fluctuations, and socioeconomic variables like recent strikes affecting various sectors in England.

        Locomizer's dataset has a range of possibilities for spatial analysis, and many still need to be explored within the scope of this study. It holds the potential to solve travel patterns based on transportation modes and varying times of day to understand how these factors impact the city's fabric throughout the day.
        
        Regarding features, this analysis has focused primarily on geographical data linked to the points of interest dataset. However, the Deep Gravity Model, which can accommodate up to 18 features in its vector, offers opportunities for greater complexity. Integrating additional databases like OpenStreetMap could add a deeper understanding of the study area's geographical intricacies, reflecting mobility patterns and the factors driving people's movements within the city.
        
        Including the population census dataset proved instrumental in running the four models. Nevertheless, it would be of immense value if Locomizer's Mobility data could provide information on the "Visitation Modality" beyond just worker users and residents. While the dataset's documentation indicates the availability of this information, the version used in this research did not include it. Access to resident data would enhance data integrity and offer insights into user movement patterns within the same Locomizer data ecosystem.
        
        The remarkable performance of the Deep Gravity Model stands out, even when handling substantial datasets. The model's capability extends to analysing hexagons up to level 9, encompassing 17,636 hexagons and 300 million origin and destination possibilities. Therefore, it underscores the potential of employing cutting-edge models and incorporating machine learning techniques like deep learning to tackle the complexity of contemporary databases that demand enhanced computational capabilities.
        
        The primary concern is that the two primary metrics commonly utilised in this context, namely R2 and RMSE/SRMSE, have previously been indicated as inadequate representations of the actual inherent model performance due to the unique characteristics of spatial interaction flow. Consequently, this can result in erroneous deductions regarding relative performance (Knudsen \& Fotheringham, 1986) \cite{wilkinsonSpatialInteractionModels2023}
        
        Lastly, the scope of this analysis is limited to a specific day of the year. A broader temporal evaluation, encompassing an extended period, would greatly contribute to understanding the model's performance over time, enabling insights into its stability and consistency across varying time frames.

        Despite the complexity of the datasets involved, particularly the Mobility Data, and the inclusion of multiple models (totalling four models), the principal focus of this study remains centred on utilising RMSE as the primary parameter and supplementing it with R-squared for individual model performance.

        However, it is crucial to acknowledge the limitations \cite{wilkinsonSpatialInteractionModels2023} outlined for a more comprehensive analysis. As emphasized by Wilkinson, when assessing the efficacy of spatial interaction models, it becomes crucial to account for the outcomes generated by these models, ensuring their alignment with the dataset. He warns against only using a single metric for evaluation, as such an approach might generate inaccurate conclusions regarding modelling performance. Thus, it resonates with the view that an evaluation is necessary to avoid misguided interpretations.
        
        Furthermore, \cite{wilkinsonSpatialInteractionModels2023} highlights a key consideration - the overall usage of two key metrics, R-squared and RMSE/SRMSE, may not necessarily capture the genuine underlying performance of a model. It is attributed to the inherent characteristics of spatial interaction flow, leading to potential inaccuracies in determining relative performance. Knudsen and Fotheringham (1986) suggest that these metrics might only partially reflect the true model performance due to the complex dynamics inherent in spatial interaction.
        
        Combining these perspectives, it is evident that while RMSE and R-squared offer valuable insights, their limitations must be acknowledged. Particularly, the exclusion of additional evaluation criteria and the potential inadequacy of certain metrics in capturing complex spatial dynamics need to be recognised. Additionally, as Wilkinson (2023) recommends, understanding how different features and datasets contribute to model performance is vital, especially in scenarios involving the integration of new datasets
        






